---
nest::cflags: '-march=haswell -O2 -pipe -ggdb'
nest::cpu_flags_x86: 'aes avx avx2 fma3 mmx mmxext popcnt sse sse2 sse3 sse4_1 sse4_2 ssse3'
nest::use: ['numa']

nest::package_keywords:
  # ZFS
  sys-fs/zfs: {}
  sys-fs/zfs-kmod: {}

nest::package_use:
  # For Dracut liveimg module
  net-misc/iputils:
    use: 'arping'

nest::kernel_config:
  CONFIG_GENTOO_LINUX_INIT_SYSTEMD: y
  CONFIG_NUMA_BALANCING: y
  CONFIG_USER_NS: y
  CONFIG_X86_X2APIC: y
  CONFIG_MCORE2: y
  CONFIG_GENERIC_CPU: n
  CONFIG_TRANSPARENT_HUGEPAGE: y
  CONFIG_X86_INTEL_PSTATE: y
  CONFIG_INTEL_IDLE: y
  CONFIG_PCI_STUB: y
  CONFIG_X86_SYSFB: y
  CONFIG_BRIDGE: m
  CONFIG_VLAN_8021Q: m
  CONFIG_BLK_DEV_NVME: m
  CONFIG_SCSI_LOWLEVEL: y
  CONFIG_SCSI_AACRAID: m
  CONFIG_SCSI_VIRTIO: m
  CONFIG_MD_RAID1: m
  CONFIG_DM_CRYPT: m
  CONFIG_DM_SNAPSHOT: m
  CONFIG_DM_THIN_PROVISIONING: m
  CONFIG_BT: m
  CONFIG_BT_RFCOMM: m
  CONFIG_BT_HIDP: m
  CONFIG_BT_HCIBTUSB: m
  CONFIG_BONDING: m
  CONFIG_E1000E: m
  CONFIG_IGB: m
  CONFIG_USB_USBNET: m
  CONFIG_IWLWIFI: m
  CONFIG_IWLMVM: m
  CONFIG_IPMI_HANDLER: m
  CONFIG_IPMI_DEVICE_INTERFACE: m
  CONFIG_IPMI_SI: m
  CONFIG_HW_RANDOM_VIRTIO: m
  CONFIG_I2C_CHARDEV: m
  CONFIG_MISC_RTSX_PCI: m
  CONFIG_FB_SIMPLE: y
  CONFIG_LOGO: n
  CONFIG_UHID: m
  CONFIG_HID_LOGITECH_DJ: m
  CONFIG_USB_XHCI_HCD: m
  CONFIG_USB_SERIAL: m
  CONFIG_USB_SERIAL_CP210X: m
  CONFIG_VFIO: m
  CONFIG_VFIO_PCI: m
  CONFIG_VIRTIO_PCI: m
  CONFIG_VIRTIO_BALLOON: m
  CONFIG_THINKPAD_ACPI: m
  CONFIG_IRQ_REMAP: y
  CONFIG_CRYPTO_XTS: m
  CONFIG_CRYPTO_AES_NI_INTEL: m
  CONFIG_CRYPTO_SERPENT: m
  CONFIG_CRYPTO_SERPENT_SSE2_X86_64: m
  CONFIG_CRYPTO_SERPENT_AVX_X86_64: m
  CONFIG_CRYPTO_SERPENT_AVX2_X86_64: m
  CONFIG_CRYPTO_TWOFISH: m
  CONFIG_CRYPTO_TWOFISH_COMMON: m
  CONFIG_CRYPTO_TWOFISH_X86_64: m
  CONFIG_CRYPTO_TWOFISH_X86_64_3WAY: m
  CONFIG_CRYPTO_TWOFISH_AVX_X86_64: m
  CONFIG_CRYPTO_USER_API_SKCIPHER: m
  CONFIG_CRYPTO_DEFLATE: m  # for ZLIB_DEFLATE, an spl requirement
  CONFIG_KVM: m
  CONFIG_KVM_INTEL: m
  CONFIG_VHOST_NET: m

  # For libvirt
  CONFIG_MEMCG: y
  CONFIG_MEMCG_SWAP: y
  CONFIG_BRIDGE_NF_EBTABLES: m
  CONFIG_BRIDGE_EBT_T_NAT: m
  CONFIG_BRIDGE_EBT_MARK_T: m
  CONFIG_NETFILTER_ADVANCED: y
  CONFIG_NETFILTER_XT_TARGET_CHECKSUM: m
  CONFIG_NETFILTER_XT_CONNMARK: m
  CONFIG_NET_SCH_HTB: m
  CONFIG_NET_SCH_SFQ: m
  CONFIG_NET_SCH_INGRESS: m
  CONFIG_NET_CLS_FW: m
  CONFIG_NET_CLS_U32: m
  CONFIG_NET_ACT_POLICE: m
  CONFIG_MACVLAN: m
  CONFIG_MACVTAP: m

  # For docker
  CONFIG_CFS_BANDWIDTH: y
  CONFIG_BLK_CGROUP: y
  CONFIG_CGROUP_PIDS: y
  CONFIG_CGROUP_DEVICE: y
  CONFIG_CGROUP_HUGETLB: y
  CONFIG_CGROUP_PERF: y
  CONFIG_BLK_DEV_THROTTLING: y
  CONFIG_NETFILTER_XT_MATCH_IPVS: m
  CONFIG_IP_VS: m
  CONFIG_IP_VS_PROTO_TCP: y
  CONFIG_IP_VS_PROTO_UDP: y
  CONFIG_IP_VS_RR: m
  CONFIG_IP_VS_NFCT: y
  CONFIG_NET_CLS_CGROUP: m
  CONFIG_NET_L3_MASTER_DEV: y
  CONFIG_CGROUP_NET_PRIO: y
  CONFIG_DUMMY: m
  CONFIG_IPVLAN: m
  CONFIG_VXLAN: m
  CONFIG_VETH: m
  CONFIG_OVERLAY_FS: m

  # For powertop
  CONFIG_CPU_FREQ_STAT: y

  # Allow kernel ticks to be disabled on cpus specified at the command line
  # (for certain virtualization workloads)
  CONFIG_NO_HZ_IDLE: n
  CONFIG_NO_HZ_FULL: y

# Support new multilib layout in Gentoo 17.1 profile
apache::lib_path: '/usr/lib64/apache2/modules'
